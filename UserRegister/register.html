<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta id="viewport" name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0">
    <title>注册-海洋牧场交易平台</title>
   <!--引入bootstrap-->
    <link rel="stylesheet" href="../plugin/bootstrap-3.3.7-dist/css/bootstrap.min.css"/>
    <!--引入FontAwesome-->
    <link rel="stylesheet" type="text/css" href="../plugin/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--引入css样式-->
    <link rel="stylesheet" type="text/css" href="../Common/css/universal.css">
</head>
<body>
<!--导航条-->
<nav class="navbar navbar-default navbar-fixed-top" >
    <div class="container">
        <div class="navbar-header visible-xs">
            <a href="" class="navbar-brand ">海洋牧场交易平台</a>
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>
        <div class="row">
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="n col-md-1 col-xs-1"></ul>
                <ul class="nav navbar-nav navbar-left col-md-5 col-xs-5 hidden-xs hidden-sm">
                    <li class="navbar-text glyphicon glyphicon-envelope" aria-hidden="true">
                        Email:haiyang@hg.com
                    </li>
                    <li class="navbar-text">
                        /
                    </li>
                    <li class="navbar-text glyphicon glyphicon-earphone" aria-hidden="true">
                        Phone:1234567898
                    </li>
                </ul>

                <ul class="nav navbar-nav navbar-right" style="margin-right: 20px;display: none" id="login">
                    <li>
                        <a href="/UserLogin/login.html">
                            登录
                        </a>
                    </li>
                    <li>
                        <a href="register.html">
                            注册
                        </a>

                    </li>
                </ul>
                <ul class="col-md-2 col-xs-2 visible-xs"></ul>
                <ul class="nav navbar-nav navbar-right col-md-4 col-xs-4" id="users" style="display: none">
                    <li>
                        <img
                                src="../image/portrait.png"
                                alt="portrait"
                                class="img-responsive img-circle center-block"
                                style="margin-top: 10px">
                    </li>
                    <li class="dropdown">
                        <a href="" class="dropdown-toggle" data-toggle="dropdown" >katle <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="">
                                    <i
                                            class="fa fa-user-circle-o"
                                            aria-hidden="true"
                                    ></i>
                                    个人信息
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    <i
                                            class="fa fa-cog"
                                            aria-hidden="true"
                                    ></i>
                                    个性设置
                                </a>
                            </li>
                            <li><a href="">
                                <i
                                        class="fa fa-cube"
                                        aria-hidden="true"
                                ></i>
                                喜爱收藏</a></li>
                            <li>
                                <a href="">
                                    <i
                                            class="fa fa-sign-out"
                                            aria-hidden="true"
                                    ></i>
                                    安全退出
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="">我的订单</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</nav>

<!--搜索栏-->
<div class="container" style="margin-top: 70px;">
    <div class="row">
        <div class=" col-md-4 hidden-xs hidden-md">
            <img src="../image/logo3.png" alt="logo">
        </div>
        <div class="col-xs-12 col-sm-12 col-md-5 hidden-xs hidden-md">
            <form action="" class="from-search row">
                <div style="height: 45px ;width: 100%">
                    <span class="dropdown" id="kind" style="width:20%">
                        <span class="dropdown-toggle" data-toggle="dropdown" style="width: 80%">
                            商品分类
                            <span class="caret"></span>
                        </span>
                        <ul class="dropdown-menu">
                            <li>
                                <a href="">
                                    新鲜海鱼
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    新鲜海虾
                                </a>
                            </li>
                            <li>
                                <a href="">
                                新鲜扇贝
                                </a>
                            </li>
                            <li>
                                <a href="">
                                    新鲜生蚝
                                </a>
                            </li>
                        </ul>
                    </span>
                    <input class="searchInput" type="text" style="width:60%;border-left: 1px solid #9d9d9d;padding:10px;height: 38px;">
                    <button id="icon" type="submit" style="width:10%" name="mouseColor">
                        <i id="icon_items"  class="fa fa-search fa-lg" aria-hidden="true"></i>
                    </button>
                </div>
            </form>
        </div>
        <div id="shopCart" name="showHide" class="col-xs-12 col-sm-3 col-md-3 hidden-xs hidden-md" style="width: 25%;margin-top: 5px;height: 80px;display: none">
            <div  class="shoppingCart" id="shoppingCart">
                <i class="fa fa-shopping-cart fa-fw fa-1x" aria-hidden="true"></i>
                我的购物车
            </div>
            <div id="shopCart_items">
                购物车空空如也！
                <a href="">登录</a>
            </div>
        </div>
    </div>
</div>

<!--表单栏-->
<div class="loginForm" style="margin-bottom:100px">
    <div class="loginHead">
        <span class="head-left">
            注册
        </span>
        <a href="../UserLogin/login.html" class="head-right" style="font-size: 12px">
            立即登录
        </a>
        <span class="head-right" style="font-size: 12px">
            我有账号？
        </span>
    </div>
    <form action="" class="form">
        <div class="form-group">
            <span>
                用户名
            </span>
            <input type="text" class="form-control" id="username">
        </div>
        <div class="form-group">
            <span>
                输入密码
            </span>
            <input type="password" class="form-control" id="password">
        </div>
        <div class="form-group">
            <span>
                确认密码
            </span>
            <input type="password" class="form-control" id="passwordAgain">
        </div>
        <div class="form-group">
            <span>
                邮箱
            </span>
            <input type="email" class="form-control" id="email">
        </div>
        <div class="form-group">
            <span>
                电话
            </span>
            <div class="phone_check">
             <span>
                <input type="text" class="form-control col-md-6" id="phone" style="width: 55%">
                <a class="checkNumber1" onclick="sends.send();">发送验证码</a>
            </span>
            </div>
        </div>
        <div class="form-group">
            <span>
                验证码
            </span>
            <input type="text" class="form-control" id="check"/>
        </div>
        <div class="form-group registerBtn">
            <a
                    type="submit"
                    class="form-control"
                    style="color: #ffffff;text-align: center"
                    onclick="register()"
            >
                注册
            </a>
        </div>
    </form>
</div>

<!--底部栏-->
<div class="bottom">
    <nav class="navbar navbar-default navbar-fixed-bottom navbar-inverse">
        <div class="container">
            @海洋牧场交易平台
        </div>
    </nav>
</div>

<!--    引入jquery-->
<script src="../plugin/jquery-2.1.4/jquery.min.js"></script>
<!--引用bootstrap   -->
<script src="../plugin/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
<!--    引入js-->
<script src="../Common/js/commom.js"></script>

<script type="text/javascript">
    /*注册*/
    function register() {
        var username = $('#username').val()
        var password = $('#password').val()
        var passwordAgain = $('#passwordAgain').val()
        var email = $('#email').val()
        var phoneNumber = $('#phone').val()
        var code = $('#check').val()
        var reg = /^[A-Za-z0-9+]+[A-Za-z0-9\.\_\-+]*@([A-Za-z0-9\-]+\.)+[A-Za-z0-9]+$/;

        if(
            username.trim() === ''||
            password.trim() === ''||
            passwordAgain.trim() === '' ||
            email.trim() === ''||
            code.trim() === ''||
            phoneNumber.trim() === '')
        {
            alert('输入不能为空')
        }
        else if(password !== passwordAgain){
            alert('输入的密码不一致')
        }
        else if(!email.match(reg)){
            alert('邮箱格式不正确')
        }

        $.ajax({
            type:'POST',
            url:'http://39.108.184.155:8080/searanch/userRegister',
            dataType: 'JSON',
            contentType: 'application/json',
            xhrFields: {
                withCredentials:true
            },
            data:JSON.stringify({
                username:username,
                password:password,
                email:email,
                phoneNumber:phoneNumber,
                code:code
            }),
            success:function (result) {
                if(result.code === 200){
                    alert("注册成功")
                    location.href = '../UserLogin/login.html'
                    console.log(result.message)
                }
                else{
                    alert(result.message)
                    console.log(result.message)
                }
            },
            error:function (error) {
                console.log(error,'error')
            }

        })
    }
    /*获取验证码*/
    var sends = {
        checked:1,
        send:function () {
            var numbers = /^1\d{10}$/
            var phoneNumber = $('#phone').val().replace(/\s+/g,"")//获取输入手机号

            if(!numbers.test(phoneNumber) || phoneNumber.length === 0){
                alert("请输入正确的手机格式！")
                return false
            }
            $.ajax({
                type:'POST',
                url:'http://39.108.184.155:8080/searanch/getMessageCode',
                dataType: 'JSON',
                xhrFields:{
                    withCredentials: true
                },
                data:{
                    phoneNumber:phoneNumber
                },
                success:function (result) {
                    console.log(result)
                    alert('验证码发送成功')
                }
            })

            if(numbers.test(phoneNumber)){
                var time = 60;
                function timeCountDown() {
                    if(time === 0){
                        clearInterval(timer)
                        $('.phone_check a').addClass('checkNumber1').removeClass('checkNumber2').html("发送验证码")
                        sends.checked = 1
                        return true
                    }
                    $('.phone_check a').html(time + 's后再次发送')
                    time--;
                    return false
                    sends.checked = 0
                }
                $('.phone_check a').addClass('checkNumber2').removeClass("checkNumber1")
                timeCountDown()
                var timer = setInterval(timeCountDown,1000)
            }
        }
    }

</script>
</body>
</html>
